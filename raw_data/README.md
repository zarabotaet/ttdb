# Управление данными оснований

Эта папка содержит все инструменты для работы с данными о основаниях для настольного тенниса.

## Файлы

### Исходные данные

- `all_blades_stervinou.csv` - автоматически парсится с сайта stervinou.net
- `manual_blades.csv` - файл для ручного добавления/редактирования данных

### Результат

- `all_blades.csv` - объединённый файл (автоматически копируется в `public/parsing/`)

### Скрипты

- `ttbdb_parser.js` - парсер сайта stervinou.net
- `merge-csv.js` - скрипт объединения двух CSV файлов
- `package.json` - зависимости и команды

## Команды

### Установка зависимостей

```bash
npm install
```

### Парсинг данных с сайта

```bash
npm run parse
# или
npm start
```

### Объединение файлов

```bash
npm run merge
```

### Полное обновление (парсинг + объединение)

```bash
npm run update
```

## Рабочий процесс

### 1. Ручное добавление данных

1. Откройте файл `manual_blades.csv`
2. Добавьте новые строки или отредактируйте существующие
3. Выполните `npm run merge`

### 2. Обновление данных с сайта

1. Выполните `npm run parse` - создаст `all_blades_stervinou.csv`
2. Выполните `npm run merge` - объединит с ручными данными
3. Или используйте `npm run update` для выполнения обеих операций

### 3. Полное обновление из корневой папки

```bash
# Из корня проекта
npm run parse-data    # Парсинг данных
npm run merge-csv     # Объединение файлов
npm run update-data   # Полное обновление + генерация enum'ов
```

## Формат данных

### Заголовки CSV

```csv
Brand,Model,Nb plies,Weight (g),Thick. (mm),Ply 1,Ply 2,Ply 3,Ply 4,Ply 5,Ply 6,Ply 7,Ply 8,Ply 9
```

### Пример записи

```csv
Butterfly,Viscaria,7,90,5.9,Limba,Arylate Carbon,Limba,Koto,Limba,Arylate Carbon,Limba
```

## Логика объединения

1. **Приоритет ручных данных**: Если основание с одинаковой комбинацией бренда и модели есть в обоих файлах, используются данные из `manual_blades.csv`

2. **Автоматическое копирование**: Результат автоматически копируется в `public/parsing/all_blades.csv` для использования приложением

3. **Логирование**: Скрипт показывает какие записи были добавлены, пропущены или перезаписаны

## Примеры использования

### Добавление нового основания

```csv
# В manual_blades.csv добавьте:
MyBrand,MyBlade,5,85,5.5,Limba,Carbon,Ayous,Carbon,Limba
```

### Исправление данных из парсера

```csv
# Если парсер неправильно определил данные для Butterfly Viscaria,
# добавьте правильную запись в manual_blades.csv:
Butterfly,Viscaria,7,90,5.9,Limba,Arylate Carbon,Limba,Koto,Limba,Arylate Carbon,Limba
```

### Удаление основания

Просто не включайте его в `manual_blades.csv` и убедитесь, что его нет в результатах парсинга.
